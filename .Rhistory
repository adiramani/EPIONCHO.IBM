print_progress = TRUE,
morbidity_module2 = "YES")
warnings()
debugonce(ep.equi.sim)
ep.equi.sim(time.its = timesteps,
ABR = ABR.in,
N.in = 440,
treat.int = trt.int,
treat.prob = 0.65,
give.treat = give.treat.in,
treat.start = treat.strt,
treat.stop = treat.stp,
pnc = 0.05,
min.mont.age = 5,
vector.control.strt = NA, #
delta.hz.in = 0.186,
delta.hinf.in = 0.003,
c.h.in = 0.005,
gam.dis.in = 0.3,
run_equilibrium = TRUE,
equilibrium,
print_progress = TRUE,
morbidity_module2 = "YES")
View(skin.disease.probs)
devtools::load_all()
timesteps = 130
#should treatment be given, when and how often
give.treat.in = 0
treat.strt = 1; treat.stp = 16
trt.int = 1
#annual biting rate, which determines infection prevalence (60% microfilarae prevalence)
ABR.in = 607 # 50% mf prev
output_equilibrium_morbidity <- ep.equi.sim(time.its = timesteps,
ABR = ABR.in,
N.in = 440,
treat.int = trt.int,
treat.prob = 0.65,
give.treat = give.treat.in,
treat.start = treat.strt,
treat.stop = treat.stp,
pnc = 0.05,
min.mont.age = 5,
vector.control.strt = NA, #
delta.hz.in = 0.186,
delta.hinf.in = 0.003,
c.h.in = 0.005,
gam.dis.in = 0.3,
run_equilibrium = TRUE,
equilibrium,
print_progress = TRUE,
morbidity_module2 = "YES")
names(output_equilibrium_morbidity)
output_equilibrium_morbidity <- output_equilibrium_morbidity_chesnaisABR
tme <- seq(1, 130*366-1)/366
plot(tme, output_equilibrium_morbidity$mf_prev, type = 'l', xlab = 'time (years)', ylab = 'microfilarial prevalence', ylim = c(0, 1))
tail(output_equilibrium_morbidity$mf_prev)
mean(tail(output_equilibrium_morbidity$mf_prev))
tme2 <- seq(1, 130*366)/366
plot(tme2, output_equilibrium_morbidity$severe_itch_prev, type = 'l', xlab = 'time (years)', ylab = 'Severe itch prevalence', ylim = c(0, 1))
tail(output_equilibrium_morbidity$severe_itch_prev)
mean(tail(output_equilibrium_morbidity$severe_itch_prev))
plot(tme2, output_equilibrium_morbidity$RSD_prev, type = 'l', xlab = 'time (years)', ylab = 'Reactive skin disease prevalence', ylim = c(0, 1))
tail(output_equilibrium_morbidity$RSD_prev)
mean(tail(output_equilibrium_morbidity$RSD_prev))
plot(tme2, output_equilibrium_morbidity$atrophy_prev, type = 'l', xlab = 'time (years)', ylab = 'Skin atrophy prevalence', ylim = c(0, 1))
tail(output_equilibrium_morbidity$atrophy_prev)
mean(tail(output_equilibrium_morbidity$atrophy_prev))
plot(tme2, output_equilibrium_morbidity$hanging_groin_prev, type = 'l', xlab = 'time (years)', ylab = 'Hanging groin prevalence', ylim = c(0, 1))
tail(output_equilibrium_morbidity$hanging_groin_prev)
mean(tail(output_equilibrium_morbidity$hanging_groin_prev))
plot(tme2, output_equilibrium_morbidity$depigmentation_prev, type = 'l', xlab = 'time (years)', ylab = 'depigmentation prevalence', ylim = c(0, 1))
tail(output_equilibrium_morbidity$depigmentation_prev)
mean(tail(output_equilibrium_morbidity$depigmentation_prev))
names(output_equilibrium_morbidity)
ageprev_out <- output_equilibrium_morbidity$morbidity_ageprev_out
# SI modelled age-prev #
SI_0_1 <- mean(tail(ageprev_out$SI_prev0_1))
SI_2_4 <- mean(tail(ageprev_out$SI_prev2_4))
SI_5_9 <- mean(tail(ageprev_out$SI_prev5_9))
SI_10_19 <- mean(tail(ageprev_out$SI_prev10_19))
SI_20_29 <- mean(tail(ageprev_out$SI_prev20_29))
SI_30_49 <- mean(tail(ageprev_out$SI_prev30_49))
SI_50_80 <- mean(tail(ageprev_out$SI_prev50_80))
SI_ageprev_vec <- c(SI_0_1, SI_2_4, SI_5_9, SI_10_19, SI_20_29, SI_30_49, SI_50_80)
age_vec <- c(1, 3, 7.5, 15, 25, 40, 65)
SI_ageprev_df <- data.frame(age = age_vec, prop = SI_ageprev_vec)
SI_ageprev_df$prev <- SI_ageprev_df$prop * 100
SI_ageprev_df$sequela <- as.factor("severe itching")
SI_ageprev_df$agecat <- c("0 - 1", "2 - 4", "5 - 9", "10 - 19", "20 - 29", "30 - 49", "50 - 80")
SI_ageprev_df$agecat2 <- ordered(SI_ageprev_df$agecat, levels = c("0 - 1", "2 - 4", "5 - 9", "10 - 19", "20 - 29", "30 - 49", "50 - 80"))
require(ggplot2)
ggplot(data = SI_ageprev_df, aes(x = agecat2, y =prev, group = sequela))+
geom_point()+
geom_line()
Atrp_0_1 <- mean(tail(ageprev_out$Atrp_prev0_1))
Atrp_2_4 <- mean(tail(ageprev_out$Atrp_prev2_4))
Atrp_5_9 <- mean(tail(ageprev_out$Atrp_prev5_9))
Atrp_10_19 <- mean(tail(ageprev_out$Atrp_prev10_19))
Atrp_20_29 <- mean(tail(ageprev_out$Atrp_prev20_29))
Atrp_30_49 <- mean(tail(ageprev_out$Atrp_prev30_49))
Atrp_50_80 <- mean(tail(ageprev_out$Atrp_prev50_80))
Atrp_ageprev_vec <- c(Atrp_0_1, Atrp_2_4, Atrp_5_9, Atrp_10_19, Atrp_20_29, Atrp_30_49, Atrp_50_80)
age_vec <- c(1, 3, 7.5, 15, 25, 40, 65)
Atrp_ageprev_df <- data.frame(age = age_vec, prop = Atrp_ageprev_vec)
Atrp_ageprev_df$prev <- Atrp_ageprev_df$prop * 100
Atrp_ageprev_df$sequela <- as.factor("atrophy")
Atrp_ageprev_df$agecat <- c("0 - 1", "2 - 4", "5 - 9", "10 - 19", "20 - 29", "30 - 49", "50 - 80")
Atrp_ageprev_df$agecat2 <- ordered(Atrp_ageprev_df$agecat, levels = c("0 - 1", "2 - 4", "5 - 9", "10 - 19", "20 - 29", "30 - 49", "50 - 80"))
ggplot(data = Atrp_ageprev_df, aes(x = agecat2, y =prev, group = sequela))+
geom_point()+
geom_line()
# hanging groin modelled age-prev #
HG_0_1 <- mean(tail(ageprev_out$HG_prev0_1))
HG_2_4 <- mean(tail(ageprev_out$HG_prev2_4))
HG_5_9 <- mean(tail(ageprev_out$HG_prev5_9))
HG_10_19 <- mean(tail(ageprev_out$HG_prev10_19))
HG_20_29 <- mean(tail(ageprev_out$HG_prev20_29))
HG_30_49 <- mean(tail(ageprev_out$HG_prev30_49))
HG_50_80 <- mean(tail(ageprev_out$HG_prev50_80))
HG_ageprev_vec <- c(HG_0_1, HG_2_4, HG_5_9, HG_10_19, HG_20_29, HG_30_49, HG_50_80)
age_vec <- c(1, 3, 7.5, 15, 25, 40, 65)
HG_ageprev_df <- data.frame(age = age_vec, prop = HG_ageprev_vec)
HG_ageprev_df$prev <- HG_ageprev_df$prop * 100
HG_ageprev_df$sequela <- as.factor("hanging groin")
HG_ageprev_df$agecat <- c("0 - 1", "2 - 4", "5 - 9", "10 - 19", "20 - 29", "30 - 49", "50 - 80")
HG_ageprev_df$agecat2 <- ordered(HG_ageprev_df$agecat, levels = c("0 - 1", "2 - 4", "5 - 9", "10 - 19", "20 - 29", "30 - 49", "50 - 80"))
ggplot(data = HG_ageprev_df, aes(x = agecat2, y =prev, group = sequela))+
geom_point()+
geom_line()
# depigmentation modelled age-prev #
depigm_0_1 <- mean(tail(ageprev_out$depigm_prev0_1))
depigm_2_4 <- mean(tail(ageprev_out$depigm_prev2_4))
depigm_5_9 <- mean(tail(ageprev_out$depigm_prev5_9))
depigm_10_19 <- mean(tail(ageprev_out$depigm_prev10_19))
depigm_20_29 <- mean(tail(ageprev_out$depigm_prev20_29))
depigm_30_49 <- mean(tail(ageprev_out$depigm_prev30_49))
depigm_50_80 <- mean(tail(ageprev_out$depigm_prev50_80))
depigm_ageprev_vec <- c(depigm_0_1, depigm_2_4, depigm_5_9, depigm_10_19, depigm_20_29, depigm_30_49, depigm_50_80)
age_vec <- c(1, 3, 7.5, 15, 25, 40, 65)
depigm_ageprev_df <- data.frame(age = age_vec, prop = depigm_ageprev_vec)
depigm_ageprev_df$prev <- depigm_ageprev_df$prop * 100
depigm_ageprev_df$sequela <- as.factor("depigmentation")
depigm_ageprev_df$agecat <- c("0 - 1", "2 - 4", "5 - 9", "10 - 19", "20 - 29", "30 - 49", "50 - 80")
depigm_ageprev_df$agecat2 <- ordered(depigm_ageprev_df$agecat, levels = c("0 - 1", "2 - 4", "5 - 9", "10 - 19", "20 - 29", "30 - 49", "50 - 80"))
ggplot(data = depigm_ageprev_df, aes(x = agecat2, y =prev, group = sequela))+
geom_point()+
geom_line()
#murdoch_data2_endemic <- subset(murdoch_data2, mesonon == 1)
murdoch_data2_nonendemic <- subset(murdoch_data2, mesonon == 0)
library(haven)
murdoch_data <- read_dta('C:/Users/mad206/OneDrive/EPIONCH-IBM BoD/Skin disease/Murdoch data/pntd.0005489.s001 (1).dta')
murdoch_data2 <- murdoch_data[!is.na(murdoch_data$mfbin),]
library(dplyr)
# ============================================ #
#        overall prevalence's                  #
# ============================================ #
#murdoch_data2_endemic <- subset(murdoch_data2, mesonon == 1)
murdoch_data2_nonendemic <- subset(murdoch_data2, mesonon == 0)
#n_endemic <- nrow(murdoch_data2_endemic)
n_nonendemic <- nrow(murdoch_data2_nonendemic)
#avg.age.cohort.endemic <- mean(murdoch_data2_endemic$age)
avg.age.cohort.nonendemic <- mean(murdoch_data2_nonendemic$age)
murdoch_data2_endemic <- subset(murdoch_data2, mesonon == 1 & mfbin > 0)
avg.age.cohort.endemic <- mean(murdoch_data2_endemic$age)
n_endemic <- nrow(murdoch_data2_endemic)
# atrophy #
atrp_x <- sum(murdoch_data2_endemic$atrophy)
#atrp_x <- sum(murdoch_data2_endemic1$atrophy)
atrp_prev <- atrp_x/n_endemic
atrp_x_nonendm <- sum(murdoch_data2_nonendemic$atrophy)
atrp_prev_nonendm <- atrp_x_nonendm/n_nonendemic
atrp_adj_prev <- atrp_prev - atrp_prev_nonendm
atrp.adj.prop.age <- atrp_adj_prev/avg.age.cohort.endemic
#atrp.adj.prop.age <- atrp_adj_prev/avg.age.cohort.endemic1
atrp_age_pro <- atrp_prev/avg.age.cohort.endemic
#atrp_age_pro <- atrp_prev/avg.age.cohort.endemic1
atrp_age_pro2 <- atrp_prev_nonendm/avg.age.cohort.nonendemic
atrp.adj.prop.age <- atrp_adj_prev/avg.age.cohort.endemic
#atrp.adj.prop.age <- atrp_adj_prev/avg.age.cohort.endemic1
atrp.adj.prop.age2 <- atrp_age_pro - atrp_age_pro2
atrp.adj.prop.age2
# hanging groin #
hg_x <- sum(murdoch_data2_endemic$hanggroin)
hg_prev <- hg_x/n_endemic
hg_x_nonendm <- sum(murdoch_data2_nonendemic$hanggroin)
hg_prev_nonendm <- hg_x_nonendm/n_nonendemic
hg_adj_prev <- hg_prev - hg_prev_nonendm
hg.adj.prop.age <- hg_adj_prev/avg.age.cohort.endemic
depigm_x <- sum(murdoch_data2_endemic$hypo)
depigm_prev <- depigm_x/n_endemic
depigm_x_nonendm <- sum(murdoch_data2_nonendemic$hypo)
depigm_prev_nonendm <- depigm_x_nonendm/n_nonendemic
depigm_adj_prev <- depigm_prev - depigm_prev_nonendm
depigm.adj.prop.age <- depigm_adj_prev/avg.age.cohort.endemic
depigm.adj.prop.age
# atrophy #
atrp_x <- sum(murdoch_data2_endemic$atrophy)
#atrp_x <- sum(murdoch_data2_endemic1$atrophy)
atrp_prev <- atrp_x/n_endemic
atrp_x_nonendm <- sum(murdoch_data2_nonendemic$atrophy)
atrp_prev_nonendm <- atrp_x_nonendm/n_nonendemic
atrp_adj_prev <- atrp_prev - atrp_prev_nonendm
atrp.adj.prop.age <- atrp_adj_prev/avg.age.cohort.endemic
#atrp.adj.prop.age <- atrp_adj_prev/avg.age.cohort.endemic1
atrp_age_pro <- atrp_prev/avg.age.cohort.endemic
atrp_age_pro2 <- atrp_prev_nonendm/avg.age.cohort.nonendemic
atrp.adj.prop.age2
# hanging groin #
hg_x <- sum(murdoch_data2_endemic$hanggroin)
hg_prev <- hg_x/n_endemic
hg_x_nonendm <- sum(murdoch_data2_nonendemic$hanggroin)
hg_prev_nonendm <- hg_x_nonendm/n_nonendemic
hg_adj_prev <- hg_prev - hg_prev_nonendm
hg.adj.prop.age <- hg_adj_prev/avg.age.cohort.endemic
hg.adj.prop.age
depigm_x <- sum(murdoch_data2_endemic$hypo)
depigm_prev <- depigm_x/n_endemic
depigm_x_nonendm <- sum(murdoch_data2_nonendemic$hypo)
depigm_prev_nonendm <- depigm_x_nonendm/n_nonendemic
depigm_adj_prev <- depigm_prev - depigm_prev_nonendm
depigm.adj.prop.age <- depigm_adj_prev/avg.age.cohort.endemic
depigm.adj.prop.age
devtools::load_all()
timesteps = 130
#should treatment be given, when and how often
give.treat.in = 0
treat.strt = 1; treat.stp = 16
trt.int = 1
#annual biting rate, which determines infection prevalence (60% microfilarae prevalence)
ABR.in = 607 # 50% mf prev
output_equilibrium_morbidity <- ep.equi.sim(time.its = timesteps,
ABR = ABR.in,
N.in = 440,
treat.int = trt.int,
treat.prob = 0.65,
give.treat = give.treat.in,
treat.start = treat.strt,
treat.stop = treat.stp,
pnc = 0.05,
min.mont.age = 5,
vector.control.strt = NA, #
delta.hz.in = 0.186,
delta.hinf.in = 0.003,
c.h.in = 0.005,
gam.dis.in = 0.3,
run_equilibrium = TRUE,
equilibrium,
print_progress = TRUE,
morbidity_module2 = "YES")
names(output_equilibrium_morbidity)
tme <- seq(1, 130*366-1)/366
plot(tme, output_equilibrium_morbidity$mf_prev, type = 'l', xlab = 'time (years)', ylab = 'microfilarial prevalence', ylim = c(0, 1))
tail(output_equilibrium_morbidity$mf_prev)
mean(tail(output_equilibrium_morbidity$mf_prev))
tme2 <- seq(1, 130*366)/366
plot(tme2, output_equilibrium_morbidity$severe_itch_prev, type = 'l', xlab = 'time (years)', ylab = 'Severe itch prevalence', ylim = c(0, 1))
tail(output_equilibrium_morbidity$severe_itch_prev)
mean(tail(output_equilibrium_morbidity$severe_itch_prev))
plot(tme2, output_equilibrium_morbidity$RSD_prev, type = 'l', xlab = 'time (years)', ylab = 'Reactive skin disease prevalence', ylim = c(0, 1))
tail(output_equilibrium_morbidity$RSD_prev)
mean(tail(output_equilibrium_morbidity$RSD_prev))
plot(tme2, output_equilibrium_morbidity$atrophy_prev, type = 'l', xlab = 'time (years)', ylab = 'Skin atrophy prevalence', ylim = c(0, 1))
tail(output_equilibrium_morbidity$atrophy_prev)
mean(tail(output_equilibrium_morbidity$atrophy_prev))
plot(tme2, output_equilibrium_morbidity$hanging_groin_prev, type = 'l', xlab = 'time (years)', ylab = 'Hanging groin prevalence', ylim = c(0, 1))
tail(output_equilibrium_morbidity$hanging_groin_prev)
mean(tail(output_equilibrium_morbidity$hanging_groin_prev))
plot(tme2, output_equilibrium_morbidity$depigmentation_prev, type = 'l', xlab = 'time (years)', ylab = 'depigmentation prevalence', ylim = c(0, 1))
tail(output_equilibrium_morbidity$depigmentation_prev)
mean(tail(output_equilibrium_morbidity$depigmentation_prev))
names(output_equilibrium_morbidity)
ageprev_out <- output_equilibrium_morbidity$morbidity_ageprev_out
# SI modelled age-prev #
SI_0_1 <- mean(tail(ageprev_out$SI_prev0_1))
SI_2_4 <- mean(tail(ageprev_out$SI_prev2_4))
SI_5_9 <- mean(tail(ageprev_out$SI_prev5_9))
SI_10_19 <- mean(tail(ageprev_out$SI_prev10_19))
SI_20_29 <- mean(tail(ageprev_out$SI_prev20_29))
SI_30_49 <- mean(tail(ageprev_out$SI_prev30_49))
SI_50_80 <- mean(tail(ageprev_out$SI_prev50_80))
SI_ageprev_vec <- c(SI_0_1, SI_2_4, SI_5_9, SI_10_19, SI_20_29, SI_30_49, SI_50_80)
age_vec <- c(1, 3, 7.5, 15, 25, 40, 65)
SI_ageprev_df <- data.frame(age = age_vec, prop = SI_ageprev_vec)
SI_ageprev_df$prev <- SI_ageprev_df$prop * 100
SI_ageprev_df$sequela <- as.factor("severe itching")
SI_ageprev_df$agecat <- c("0 - 1", "2 - 4", "5 - 9", "10 - 19", "20 - 29", "30 - 49", "50 - 80")
SI_ageprev_df$agecat2 <- ordered(SI_ageprev_df$agecat, levels = c("0 - 1", "2 - 4", "5 - 9", "10 - 19", "20 - 29", "30 - 49", "50 - 80"))
require(ggplot2)
ggplot(data = SI_ageprev_df, aes(x = agecat2, y =prev, group = sequela))+
geom_point()+
geom_line()
# RSD modelled age-prev #
RSD_0_1 <- mean(tail(ageprev_out$RSD_prev0_1))
RSD_2_4 <- mean(tail(ageprev_out$RSD_prev2_4))
RSD_5_9 <- mean(tail(ageprev_out$RSD_prev5_9))
RSD_10_19 <- mean(tail(ageprev_out$RSD_prev10_19))
RSD_20_29 <- mean(tail(ageprev_out$RSD_prev20_29))
RSD_30_49 <- mean(tail(ageprev_out$RSD_prev30_49))
RSD_50_80 <- mean(tail(ageprev_out$RSD_prev50_80))
RSD_ageprev_vec <- c(RSD_0_1, RSD_2_4, RSD_5_9, RSD_10_19, RSD_20_29, RSD_30_49, RSD_50_80)
age_vec <- c(1, 3, 7.5, 15, 25, 40, 65)
RSD_ageprev_df <- data.frame(age = age_vec, prop = RSD_ageprev_vec)
RSD_ageprev_df$prev <- RSD_ageprev_df$prop * 100
RSD_ageprev_df$sequela <- as.factor("RSD")
RSD_ageprev_df$agecat <- c("0 - 1", "2 - 4", "5 - 9", "10 - 19", "20 - 29", "30 - 49", "50 - 80")
RSD_ageprev_df$agecat2 <- ordered(RSD_ageprev_df$agecat, levels = c("0 - 1", "2 - 4", "5 - 9", "10 - 19", "20 - 29", "30 - 49", "50 - 80"))
ggplot(data = RSD_ageprev_df, aes(x = agecat2, y =prev, group = sequela))+
geom_point()+
geom_line()
# Atrophy modelled age-prev #
Atrp_0_1 <- mean(tail(ageprev_out$Atrp_prev0_1))
Atrp_2_4 <- mean(tail(ageprev_out$Atrp_prev2_4))
Atrp_5_9 <- mean(tail(ageprev_out$Atrp_prev5_9))
Atrp_10_19 <- mean(tail(ageprev_out$Atrp_prev10_19))
Atrp_20_29 <- mean(tail(ageprev_out$Atrp_prev20_29))
Atrp_30_49 <- mean(tail(ageprev_out$Atrp_prev30_49))
Atrp_50_80 <- mean(tail(ageprev_out$Atrp_prev50_80))
Atrp_ageprev_vec <- c(Atrp_0_1, Atrp_2_4, Atrp_5_9, Atrp_10_19, Atrp_20_29, Atrp_30_49, Atrp_50_80)
age_vec <- c(1, 3, 7.5, 15, 25, 40, 65)
Atrp_ageprev_df <- data.frame(age = age_vec, prop = Atrp_ageprev_vec)
Atrp_ageprev_df$prev <- Atrp_ageprev_df$prop * 100
Atrp_ageprev_df$sequela <- as.factor("atrophy")
Atrp_ageprev_df$agecat <- c("0 - 1", "2 - 4", "5 - 9", "10 - 19", "20 - 29", "30 - 49", "50 - 80")
Atrp_ageprev_df$agecat2 <- ordered(Atrp_ageprev_df$agecat, levels = c("0 - 1", "2 - 4", "5 - 9", "10 - 19", "20 - 29", "30 - 49", "50 - 80"))
ggplot(data = Atrp_ageprev_df, aes(x = agecat2, y =prev, group = sequela))+
geom_point()+
geom_line()
# hanging groin modelled age-prev #
HG_0_1 <- mean(tail(ageprev_out$HG_prev0_1))
HG_2_4 <- mean(tail(ageprev_out$HG_prev2_4))
HG_5_9 <- mean(tail(ageprev_out$HG_prev5_9))
HG_10_19 <- mean(tail(ageprev_out$HG_prev10_19))
HG_20_29 <- mean(tail(ageprev_out$HG_prev20_29))
HG_30_49 <- mean(tail(ageprev_out$HG_prev30_49))
HG_50_80 <- mean(tail(ageprev_out$HG_prev50_80))
HG_ageprev_vec <- c(HG_0_1, HG_2_4, HG_5_9, HG_10_19, HG_20_29, HG_30_49, HG_50_80)
age_vec <- c(1, 3, 7.5, 15, 25, 40, 65)
HG_ageprev_df <- data.frame(age = age_vec, prop = HG_ageprev_vec)
HG_ageprev_df$prev <- HG_ageprev_df$prop * 100
HG_ageprev_df$sequela <- as.factor("hanging groin")
HG_ageprev_df$agecat <- c("0 - 1", "2 - 4", "5 - 9", "10 - 19", "20 - 29", "30 - 49", "50 - 80")
HG_ageprev_df$agecat2 <- ordered(HG_ageprev_df$agecat, levels = c("0 - 1", "2 - 4", "5 - 9", "10 - 19", "20 - 29", "30 - 49", "50 - 80"))
ggplot(data = HG_ageprev_df, aes(x = agecat2, y =prev, group = sequela))+
geom_point()+
geom_line()
# depigmentation modelled age-prev #
depigm_0_1 <- mean(tail(ageprev_out$depigm_prev0_1))
depigm_2_4 <- mean(tail(ageprev_out$depigm_prev2_4))
depigm_5_9 <- mean(tail(ageprev_out$depigm_prev5_9))
depigm_10_19 <- mean(tail(ageprev_out$depigm_prev10_19))
depigm_20_29 <- mean(tail(ageprev_out$depigm_prev20_29))
depigm_30_49 <- mean(tail(ageprev_out$depigm_prev30_49))
depigm_50_80 <- mean(tail(ageprev_out$depigm_prev50_80))
depigm_ageprev_vec <- c(depigm_0_1, depigm_2_4, depigm_5_9, depigm_10_19, depigm_20_29, depigm_30_49, depigm_50_80)
age_vec <- c(1, 3, 7.5, 15, 25, 40, 65)
depigm_ageprev_df <- data.frame(age = age_vec, prop = depigm_ageprev_vec)
depigm_ageprev_df$prev <- depigm_ageprev_df$prop * 100
depigm_ageprev_df$sequela <- as.factor("depigmentation")
depigm_ageprev_df$agecat <- c("0 - 1", "2 - 4", "5 - 9", "10 - 19", "20 - 29", "30 - 49", "50 - 80")
depigm_ageprev_df$agecat2 <- ordered(depigm_ageprev_df$agecat, levels = c("0 - 1", "2 - 4", "5 - 9", "10 - 19", "20 - 29", "30 - 49", "50 - 80"))
ggplot(data = depigm_ageprev_df, aes(x = agecat2, y =prev, group = sequela))+
geom_point()+
geom_line()
devtools::load_all()
timesteps = 130
#should treatment be given, when and how often
give.treat.in = 0
treat.strt = 1; treat.stp = 16
trt.int = 1
#annual biting rate, which determines infection prevalence (60% microfilarae prevalence)
ABR.in = 607 # 50% mf prev
output_equilibrium_morbidity <- ep.equi.sim(time.its = timesteps,
ABR = ABR.in,
N.in = 440,
treat.int = trt.int,
treat.prob = 0.65,
give.treat = give.treat.in,
treat.start = treat.strt,
treat.stop = treat.stp,
pnc = 0.05,
min.mont.age = 5,
vector.control.strt = NA, #
delta.hz.in = 0.186,
delta.hinf.in = 0.003,
c.h.in = 0.005,
gam.dis.in = 0.3,
run_equilibrium = TRUE,
equilibrium,
print_progress = TRUE,
morbidity_module2 = "YES")
devtools::load_all()
#length of simulation in years
timesteps = 200
timesteps = 130
#should treatment be given, when and how often
give.treat.in = 0
treat.strt = 1; treat.stp = 16
trt.int = 1
#annual biting rate, which determines infection prevalence (60% microfilarae prevalence)
ABR.in = 607 # 50% mf prev
output_equilibrium_morbidity <- ep.equi.sim(time.its = timesteps,
ABR = ABR.in,
N.in = 440,
treat.int = trt.int,
treat.prob = 0.65,
give.treat = give.treat.in,
treat.start = treat.strt,
treat.stop = treat.stp,
pnc = 0.05,
min.mont.age = 5,
vector.control.strt = NA, #
delta.hz.in = 0.186,
delta.hinf.in = 0.003,
c.h.in = 0.005,
gam.dis.in = 0.3,
run_equilibrium = TRUE,
equilibrium,
print_progress = TRUE,
morbidity_module2 = "YES")
names(output_equilibrium_morbidity)
tme <- seq(1, 130*366-1)/366
plot(tme, output_equilibrium_morbidity$mf_prev, type = 'l', xlab = 'time (years)', ylab = 'microfilarial prevalence', ylim = c(0, 1))
tail(output_equilibrium_morbidity$mf_prev)
mean(tail(output_equilibrium_morbidity$mf_prev))
tme2 <- seq(1, 130*366)/366
plot(tme2, output_equilibrium_morbidity$atrophy_prev, type = 'l', xlab = 'time (years)', ylab = 'Skin atrophy prevalence', ylim = c(0, 1))
tail(output_equilibrium_morbidity$atrophy_prev)
mean(tail(output_equilibrium_morbidity$atrophy_prev))
plot(tme2, output_equilibrium_morbidity$hanging_groin_prev, type = 'l', xlab = 'time (years)', ylab = 'Hanging groin prevalence', ylim = c(0, 1))
tail(output_equilibrium_morbidity$hanging_groin_prev)
mean(tail(output_equilibrium_morbidity$hanging_groin_prev))
plot(tme2, output_equilibrium_morbidity$depigmentation_prev, type = 'l', xlab = 'time (years)', ylab = 'depigmentation prevalence', ylim = c(0, 1))
tail(output_equilibrium_morbidity$depigmentation_prev)
mean(tail(output_equilibrium_morbidity$depigmentation_prev))
plot(tme2, output_equilibrium_morbidity$severe_itch_prev, type = 'l', xlab = 'time (years)', ylab = 'Severe itch prevalence', ylim = c(0, 1))
tail(output_equilibrium_morbidity$severe_itch_prev)
mean(tail(output_equilibrium_morbidity$severe_itch_prev))
plot(tme2, output_equilibrium_morbidity$RSD_prev, type = 'l', xlab = 'time (years)', ylab = 'Reactive skin disease prevalence', ylim = c(0, 1))
tail(output_equilibrium_morbidity$RSD_prev)
mean(tail(output_equilibrium_morbidity$RSD_prev))
names(output_equilibrium_morbidity)
ageprev_out <- output_equilibrium_morbidity$morbidity_ageprev_out
Atrp_0_1 <- mean(tail(ageprev_out$Atrp_prev0_1))
Atrp_2_4 <- mean(tail(ageprev_out$Atrp_prev2_4))
Atrp_5_9 <- mean(tail(ageprev_out$Atrp_prev5_9))
Atrp_10_19 <- mean(tail(ageprev_out$Atrp_prev10_19))
Atrp_20_29 <- mean(tail(ageprev_out$Atrp_prev20_29))
Atrp_30_49 <- mean(tail(ageprev_out$Atrp_prev30_49))
Atrp_50_80 <- mean(tail(ageprev_out$Atrp_prev50_80))
Atrp_ageprev_vec <- c(Atrp_0_1, Atrp_2_4, Atrp_5_9, Atrp_10_19, Atrp_20_29, Atrp_30_49, Atrp_50_80)
age_vec <- c(1, 3, 7.5, 15, 25, 40, 65)
Atrp_ageprev_df <- data.frame(age = age_vec, prop = Atrp_ageprev_vec)
Atrp_ageprev_df$prev <- Atrp_ageprev_df$prop * 100
Atrp_ageprev_df$sequela <- as.factor("atrophy")
Atrp_ageprev_df$agecat <- c("0 - 1", "2 - 4", "5 - 9", "10 - 19", "20 - 29", "30 - 49", "50 - 80")
Atrp_ageprev_df$agecat2 <- ordered(Atrp_ageprev_df$agecat, levels = c("0 - 1", "2 - 4", "5 - 9", "10 - 19", "20 - 29", "30 - 49", "50 - 80"))
ggplot(data = Atrp_ageprev_df, aes(x = agecat2, y =prev, group = sequela))+
geom_point()+
geom_line()
require(gpplot2)
require(ggplot2)
Atrp_0_1 <- mean(tail(ageprev_out$Atrp_prev0_1))
Atrp_2_4 <- mean(tail(ageprev_out$Atrp_prev2_4))
Atrp_5_9 <- mean(tail(ageprev_out$Atrp_prev5_9))
Atrp_10_19 <- mean(tail(ageprev_out$Atrp_prev10_19))
Atrp_20_29 <- mean(tail(ageprev_out$Atrp_prev20_29))
Atrp_30_49 <- mean(tail(ageprev_out$Atrp_prev30_49))
Atrp_50_80 <- mean(tail(ageprev_out$Atrp_prev50_80))
Atrp_ageprev_vec <- c(Atrp_0_1, Atrp_2_4, Atrp_5_9, Atrp_10_19, Atrp_20_29, Atrp_30_49, Atrp_50_80)
age_vec <- c(1, 3, 7.5, 15, 25, 40, 65)
Atrp_ageprev_df <- data.frame(age = age_vec, prop = Atrp_ageprev_vec)
Atrp_ageprev_df$prev <- Atrp_ageprev_df$prop * 100
Atrp_ageprev_df$sequela <- as.factor("atrophy")
Atrp_ageprev_df$agecat <- c("0 - 1", "2 - 4", "5 - 9", "10 - 19", "20 - 29", "30 - 49", "50 - 80")
Atrp_ageprev_df$agecat2 <- ordered(Atrp_ageprev_df$agecat, levels = c("0 - 1", "2 - 4", "5 - 9", "10 - 19", "20 - 29", "30 - 49", "50 - 80"))
ggplot(data = Atrp_ageprev_df, aes(x = agecat2, y =prev, group = sequela))+
geom_point()+
geom_line()
HG_0_1 <- mean(tail(ageprev_out$HG_prev0_1))
HG_2_4 <- mean(tail(ageprev_out$HG_prev2_4))
HG_5_9 <- mean(tail(ageprev_out$HG_prev5_9))
HG_10_19 <- mean(tail(ageprev_out$HG_prev10_19))
HG_20_29 <- mean(tail(ageprev_out$HG_prev20_29))
HG_30_49 <- mean(tail(ageprev_out$HG_prev30_49))
HG_50_80 <- mean(tail(ageprev_out$HG_prev50_80))
HG_ageprev_vec <- c(HG_0_1, HG_2_4, HG_5_9, HG_10_19, HG_20_29, HG_30_49, HG_50_80)
age_vec <- c(1, 3, 7.5, 15, 25, 40, 65)
HG_ageprev_df <- data.frame(age = age_vec, prop = HG_ageprev_vec)
HG_ageprev_df$prev <- HG_ageprev_df$prop * 100
HG_ageprev_df$sequela <- as.factor("hanging groin")
HG_ageprev_df$agecat <- c("0 - 1", "2 - 4", "5 - 9", "10 - 19", "20 - 29", "30 - 49", "50 - 80")
HG_ageprev_df$agecat2 <- ordered(HG_ageprev_df$agecat, levels = c("0 - 1", "2 - 4", "5 - 9", "10 - 19", "20 - 29", "30 - 49", "50 - 80"))
ggplot(data = HG_ageprev_df, aes(x = agecat2, y =prev, group = sequela))+
geom_point()+
geom_line()
depigm_0_1 <- mean(tail(ageprev_out$depigm_prev0_1))
depigm_2_4 <- mean(tail(ageprev_out$depigm_prev2_4))
depigm_5_9 <- mean(tail(ageprev_out$depigm_prev5_9))
depigm_10_19 <- mean(tail(ageprev_out$depigm_prev10_19))
depigm_20_29 <- mean(tail(ageprev_out$depigm_prev20_29))
depigm_30_49 <- mean(tail(ageprev_out$depigm_prev30_49))
depigm_50_80 <- mean(tail(ageprev_out$depigm_prev50_80))
depigm_ageprev_vec <- c(depigm_0_1, depigm_2_4, depigm_5_9, depigm_10_19, depigm_20_29, depigm_30_49, depigm_50_80)
age_vec <- c(1, 3, 7.5, 15, 25, 40, 65)
depigm_ageprev_df <- data.frame(age = age_vec, prop = depigm_ageprev_vec)
depigm_ageprev_df$prev <- depigm_ageprev_df$prop * 100
depigm_ageprev_df$sequela <- as.factor("depigmentation")
depigm_ageprev_df$agecat <- c("0 - 1", "2 - 4", "5 - 9", "10 - 19", "20 - 29", "30 - 49", "50 - 80")
depigm_ageprev_df$agecat2 <- ordered(depigm_ageprev_df$agecat, levels = c("0 - 1", "2 - 4", "5 - 9", "10 - 19", "20 - 29", "30 - 49", "50 - 80"))
ggplot(data = depigm_ageprev_df, aes(x = agecat2, y =prev, group = sequela))+
geom_point()+
geom_line()
