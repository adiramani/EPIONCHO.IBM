c.h.in = 0.005,
gam.dis.in = 0.3,
run_equilibrium = TRUE,
equilibrium,
print_progress = TRUE)
devtools::load_all()
debugonce(ep.equi.sim)
# ==================================================== #
#     baseline model run                               #
# ==================================================== #
#length of simulation in years
timesteps = 30
#should treatment be given, when and how often
give.treat.in = 0
treat.strt = 1; treat.stp = 16
trt.int = 1
#annual biting rate, which determines infection prevalence
ABR.in = 1082
output_equilibrium <- ep.equi.sim(time.its = timesteps,
ABR = ABR.in,
N.in = 440,
treat.int = trt.int,
treat.prob = 0.65,
give.treat = give.treat.in,
treat.start = treat.strt,
treat.stop = treat.stp,
pnc = 0.05,
min.mont.age = 5,
delta.hz.in = 0.186,
delta.hinf.in = 0.003,
c.h.in = 0.005,
gam.dis.in = 0.3,
run_equilibrium = TRUE,
equilibrium,
print_progress = TRUE)
devtools::load_all()
#length of simulation in years
timesteps = 30
#should treatment be given, when and how often
give.treat.in = 0
treat.strt = 1; treat.stp = 16
trt.int = 1
#annual biting rate, which determines infection prevalence
ABR.in = 1082
output_equilibrium <- ep.equi.sim(time.its = timesteps,
ABR = ABR.in,
N.in = 440,
treat.int = trt.int,
treat.prob = 0.65,
give.treat = give.treat.in,
treat.start = treat.strt,
treat.stop = treat.stp,
pnc = 0.05,
min.mont.age = 5,
delta.hz.in = 0.186,
delta.hinf.in = 0.003,
c.h.in = 0.005,
gam.dis.in = 0.3,
run_equilibrium = TRUE,
equilibrium,
print_progress = TRUE)
output_equilibrium <- ep.equi.sim(time.its = timesteps,
ABR = ABR.in,
N.in = 440,
treat.int = trt.int,
treat.prob = 0.65,
give.treat = give.treat.in,
treat.start = treat.strt,
treat.stop = treat.stp,
pnc = 0.05,
min.mont.age = 5,
delta.hz.in = 0.186,
delta.hinf.in = 0.003,
c.h.in = 0.005,
gam.dis.in = 0.3,
run_equilibrium = TRUE,
equilibrium = NA,
print_progress = TRUE)
output_equilibrium <- ep.equi.sim(time.its = timesteps,
ABR = ABR.in,
N.in = 440,
treat.int = trt.int,
treat.prob = 0.65,
give.treat = give.treat.in,
treat.start = treat.strt,
treat.stop = treat.stp,
pnc = 0.05,
min.mont.age = 5,
vector.control.strt = NA,
delta.hz.in = 0.186,
delta.hinf.in = 0.003,
c.h.in = 0.005,
gam.dis.in = 0.3,
run_equilibrium = TRUE,
equilibrium = NA,
print_progress = TRUE)
devtools::load_all()
output_equilibrium <- ep.equi.sim(time.its = timesteps,
ABR = ABR.in,
N.in = 440,
treat.int = trt.int,
treat.prob = 0.65,
give.treat = give.treat.in,
treat.start = treat.strt,
treat.stop = treat.stp,
pnc = 0.05,
min.mont.age = 5,
vector.control.strt = NA,
delta.hz.in = 0.186,
delta.hinf.in = 0.003,
c.h.in = 0.005,
gam.dis.in = 0.3,
run_equilibrium = TRUE,
equilibrium = NA,
print_progress = TRUE)
devtools::load_all()
output_equilibrium <- ep.equi.sim(time.its = timesteps,
ABR = ABR.in,
N.in = 440,
treat.int = trt.int,
treat.prob = 0.65,
give.treat = give.treat.in,
treat.start = treat.strt,
treat.stop = treat.stp,
pnc = 0.05,
min.mont.age = 5,
vector.control.strt = NA,
delta.hz.in = 0.186,
delta.hinf.in = 0.003,
c.h.in = 0.005,
gam.dis.in = 0.3,
run_equilibrium = TRUE,
equilibrium = NA,
print_progress = TRUE)
names(output_equilibrium)
tme <- seq(1, 30*366-1)/366
plot(tme, output_equilibrium$mf_prev, type = 'l', xlab = 'time (years)', ylab = 'microfilarial prevalence', ylim = c(0, 1))
#length of simulation in years
timesteps = 60
#should treatment be given, when and how often
give.treat.in = 0
treat.strt = 1; treat.stp = 16
trt.int = 1
#annual biting rate, which determines infection prevalence
ABR.in = 1082
output_VC <- ep.equi.sim(time.its = timesteps,
ABR = ABR.in,
N.in = 440,
treat.int = trt.int,
treat.prob = 0.65,
give.treat = give.treat.in,
treat.start = treat.strt,
treat.stop = treat.stp,
pnc = 0.05,
min.mont.age = 5,
vector.control.strt = 20,
vector.control.duration = 20,
vector.control.efficacy = 0.7,
delta.hz.in = 0.186,
delta.hinf.in = 0.003,
c.h.in = 0.005,
gam.dis.in = 0.3,
run_equilibrium = TRUE,
equilibrium = NA,
print_progress = TRUE)
plot(tme, output_VC$mf_prev, type = 'l', xlab = 'time (years)', ylab = 'microfilarial prevalence', ylim = c(0, 1))
tme <- seq(1, 60*366-1)/366
plot(tme, output_VC$mf_prev, type = 'l', xlab = 'time (years)', ylab = 'microfilarial prevalence', ylim = c(0, 1))
names(output_VC)
eq_output <- output_VC$all_equilibrium_outputs
View(eq_output)
eq_outputs_baseline <- output_equilibrium$all_equilibrium_outputs
View(eq_outputs_baseline)
devtools::load_all()
1082*0.7
1082 - (1082 * 0.7)
devtools::load_all()
devtools::load_all()
# ==================================================== #
#     VC  model run                                    #
# ==================================================== #
#length of simulation in years
timesteps = 60
#should treatment be given, when and how often
give.treat.in = 0
treat.strt = 1; treat.stp = 16
trt.int = 1
#annual biting rate, which determines infection prevalence
ABR.in = 1082
output_VC <- ep.equi.sim(time.its = timesteps,
ABR = ABR.in,
N.in = 440,
treat.int = trt.int,
treat.prob = 0.65,
give.treat = give.treat.in,
treat.start = treat.strt,
treat.stop = treat.stp,
pnc = 0.05,
min.mont.age = 5,
vector.control.strt = 20,
vector.control.duration = 20,
vector.control.efficacy = 0.7,
delta.hz.in = 0.186,
delta.hinf.in = 0.003,
c.h.in = 0.005,
gam.dis.in = 0.3,
run_equilibrium = TRUE,
equilibrium = NA,
print_progress = TRUE)
#length of simulation in years
timesteps = 80
#should treatment be given, when and how often
give.treat.in = 0
treat.strt = 1; treat.stp = 16
trt.int = 1
#annual biting rate, which determines infection prevalence
ABR.in = 1082
output_VC <- ep.equi.sim(time.its = timesteps,
ABR = ABR.in,
N.in = 440,
treat.int = trt.int,
treat.prob = 0.65,
give.treat = give.treat.in,
treat.start = treat.strt,
treat.stop = treat.stp,
pnc = 0.05,
min.mont.age = 5,
vector.control.strt = 40,
vector.control.duration = 20,
vector.control.efficacy = 0.7,
delta.hz.in = 0.186,
delta.hinf.in = 0.003,
c.h.in = 0.005,
gam.dis.in = 0.3,
run_equilibrium = TRUE,
equilibrium = NA,
print_progress = TRUE)
names(output_VC)
tme <- seq(1, 60*366-1)/366
plot(tme, output_VC$mf_prev, type = 'l', xlab = 'time (years)', ylab = 'microfilarial prevalence', ylim = c(0, 1))
tme <- seq(1, 80*366-1)/366
plot(tme, output_VC$mf_prev, type = 'l', xlab = 'time (years)', ylab = 'microfilarial prevalence', ylim = c(0, 1))
(1082 - (1082*0.7)) * ((1/104) / 0.63)
(1082 * ((1/104) / 0.63)
)
366/(1/366)
seq(0,1,1/366)
devtools::load_all()
debugonce(ep.equi.sim)
output_VC <- ep.equi.sim(time.its = timesteps,
ABR = ABR.in,
N.in = 440,
treat.int = trt.int,
treat.prob = 0.65,
give.treat = give.treat.in,
treat.start = treat.strt,
treat.stop = treat.stp,
pnc = 0.05,
min.mont.age = 5,
vector.control.strt = 0.005464481,
vector.control.duration = 20,
vector.control.efficacy = 0.7,
delta.hz.in = 0.186,
delta.hinf.in = 0.003,
c.h.in = 0.005,
gam.dis.in = 0.3,
run_equilibrium = TRUE,
equilibrium = NA,
print_progress = TRUE)
debugonce(ep.equi.sim)
output_VC <- ep.equi.sim(time.its = timesteps,
ABR = ABR.in,
N.in = 440,
treat.int = trt.int,
treat.prob = 0.65,
give.treat = give.treat.in,
treat.start = treat.strt,
treat.stop = treat.stp,
pnc = 0.05,
min.mont.age = 5,
vector.control.strt = 0.005464481,
vector.control.duration = 20,
vector.control.efficacy = 0.7,
delta.hz.in = 0.186,
delta.hinf.in = 0.003,
c.h.in = 0.005,
gam.dis.in = 0.3,
run_equilibrium = TRUE,
equilibrium = NA,
print_progress = TRUE)
m
i
m
ABR
ABR_upd
ABR_recorded
nw.rate
mean(nw.rate)
m
i
vc.iter.strt
vc.iter.stp
vc.iter.stp/366
ABR_updated
m
ABR_upd
mean(nw.rate)
ABR_recorded
ABR_updated
m
ABR_recorded
prev
#length of simulation in years
timesteps = 80
#should treatment be given, when and how often
give.treat.in = 0
treat.strt = 1; treat.stp = 16
trt.int = 1
#annual biting rate, which determines infection prevalence
ABR.in = 5000
output_VC <- ep.equi.sim(time.its = timesteps,
ABR = ABR.in,
N.in = 440,
treat.int = trt.int,
treat.prob = 0.65,
give.treat = give.treat.in,
treat.start = treat.strt,
treat.stop = treat.stp,
pnc = 0.05,
min.mont.age = 5,
#vector.control.strt = 0.005464481,
vector.control.strt = 40,
vector.control.duration = 40,
vector.control.efficacy = 0.7,
delta.hz.in = 0.186,
delta.hinf.in = 0.003,
c.h.in = 0.005,
gam.dis.in = 0.3,
run_equilibrium = TRUE,
equilibrium = NA,
print_progress = TRUE)
devtools::load_all()
# ==================================================== #
#     VC  model run                                    #
# ==================================================== #
#length of simulation in years
timesteps = 80
#should treatment be given, when and how often
give.treat.in = 0
treat.strt = 1; treat.stp = 16
trt.int = 1
#annual biting rate, which determines infection prevalence
ABR.in = 5000
output_VC <- ep.equi.sim(time.its = timesteps,
ABR = ABR.in,
N.in = 440,
treat.int = trt.int,
treat.prob = 0.65,
give.treat = give.treat.in,
treat.start = treat.strt,
treat.stop = treat.stp,
pnc = 0.05,
min.mont.age = 5,
#vector.control.strt = 0.005464481,
vector.control.strt = 40,
vector.control.duration = 40,
vector.control.efficacy = 0.7,
delta.hz.in = 0.186,
delta.hinf.in = 0.003,
c.h.in = 0.005,
gam.dis.in = 0.3,
run_equilibrium = TRUE,
equilibrium = NA,
print_progress = TRUE)
names(output_VC)
tme <- seq(1, 80*366-1)/366
plot(tme, output_VC$ABR_recorded, type = 'l', xlab = 'time (years)', ylab = 'ABR', ylim = c(0, 1))
plot(tme, output_VC$ABR_recorded, type = 'l', xlab = 'time (years)', ylab = 'ABR', ylim = c(0, 6000))
View(output_VC)
output_VC$ABR_recorded
df.test <- as.data.frame(output_VC$ABR_recorded)
View(df.test)
40/(1/366)
14640/40
14640/366
80/(1/366)
debugonce(epi.equi.sim)
debugonce(ep.equi.sim)
output_VC <- ep.equi.sim(time.its = timesteps,
ABR = ABR.in,
N.in = 440,
treat.int = trt.int,
treat.prob = 0.65,
give.treat = give.treat.in,
treat.start = treat.strt,
treat.stop = treat.stp,
pnc = 0.05,
min.mont.age = 5,
#vector.control.strt = 0.005464481,
vector.control.strt = 40,
vector.control.duration = 40,
vector.control.efficacy = 0.7,
delta.hz.in = 0.186,
delta.hinf.in = 0.003,
c.h.in = 0.005,
gam.dis.in = 0.3,
run_equilibrium = TRUE,
equilibrium = NA,
print_progress = TRUE)
vc.iter.strt
vc.iter.stp
treat.strt  = round(80 / (DT.in )); treat.stp = treat.strt + round(treat.len / (DT.in )) #treatment start and stop
DT.in <- 1/366 #timestep must be one day
treat.len <- 15 #treatment duration in years
treat.strt  = round(80 / (DT.in )); treat.stp = treat.strt + round(treat.len / (DT.in )) #treatment start and stop
treat.len / (DT.in )
devtools::load_all()
debugonce(ep.equi.sim)
output_VC <- ep.equi.sim(time.its = timesteps,
ABR = ABR.in,
N.in = 440,
treat.int = trt.int,
treat.prob = 0.65,
give.treat = give.treat.in,
treat.start = treat.strt,
treat.stop = treat.stp,
pnc = 0.05,
min.mont.age = 5,
#vector.control.strt = 0.005464481,
vector.control.strt = 40,
vector.control.duration = 40,
vector.control.efficacy = 0.7,
delta.hz.in = 0.186,
delta.hinf.in = 0.003,
c.h.in = 0.005,
gam.dis.in = 0.3,
run_equilibrium = TRUE,
equilibrium = NA,
print_progress = TRUE)
vc.iter.strt
vc.iter.stp
devtools::load_all()
# ==================================================== #
#     VC  model run                                    #
# ==================================================== #
#length of simulation in years
timesteps = 80
#should treatment be given, when and how often
give.treat.in = 0
treat.strt = 1; treat.stp = 16
trt.int = 1
#annual biting rate, which determines infection prevalence
ABR.in = 5000
output_VC <- ep.equi.sim(time.its = timesteps,
ABR = ABR.in,
N.in = 440,
treat.int = trt.int,
treat.prob = 0.65,
give.treat = give.treat.in,
treat.start = treat.strt,
treat.stop = treat.stp,
pnc = 0.05,
min.mont.age = 5,
#vector.control.strt = 0.005464481,
vector.control.strt = 40,
vector.control.duration = 40,
vector.control.efficacy = 0.7,
delta.hz.in = 0.186,
delta.hinf.in = 0.003,
c.h.in = 0.005,
gam.dis.in = 0.3,
run_equilibrium = TRUE,
equilibrium = NA,
print_progress = TRUE)
names(output_VC)
tme <- seq(1, 80*366-1)/366
plot(tme, output_VC$ABR_recorded, type = 'l', xlab = 'time (years)', ylab = 'ABR', ylim = c(0, 6000))
plot(tme, output_VC$mf_prev, type = 'l', xlab = 'time (years)', ylab = 'microfilarial prevalence', ylim = c(0, 1))
#length of simulation in years
timesteps = 80
#should treatment be given, when and how often
give.treat.in = 0
treat.strt = 1; treat.stp = 16
trt.int = 1
#annual biting rate, which determines infection prevalence
ABR.in = 1082
output_VC <- ep.equi.sim(time.its = timesteps,
ABR = ABR.in,
N.in = 440,
treat.int = trt.int,
treat.prob = 0.65,
give.treat = give.treat.in,
treat.start = treat.strt,
treat.stop = treat.stp,
pnc = 0.05,
min.mont.age = 5,
#vector.control.strt = 0.005464481,
vector.control.strt = 40,
vector.control.duration = 40,
vector.control.efficacy = 0.7,
delta.hz.in = 0.186,
delta.hinf.in = 0.003,
c.h.in = 0.005,
gam.dis.in = 0.3,
run_equilibrium = TRUE,
equilibrium = NA,
print_progress = TRUE)
names(output_VC)
tme <- seq(1, 80*366-1)/366
plot(tme, output_VC$ABR_recorded, type = 'l', xlab = 'time (years)', ylab = 'ABR', ylim = c(0, 6000))
plot(tme, output_VC$ABR_recorded, type = 'l', xlab = 'time (years)', ylab = 'ABR', ylim = c(0, 1500))
plot(tme, output_VC$mf_prev, type = 'l', xlab = 'time (years)', ylab = 'microfilarial prevalence', ylim = c(0, 1))
