gam.dis.in = 0.3,
run_equilibrium = TRUE,
equilibrium = NA,
print_progress = TRUE)
treat.timing
devtools::load_all()
debugonce(ep.equi.sim)
timesteps = 45
#should treatment be given, when and how often
give.treat.in = 1
treat.strt = 1/366*3; treat.stp = 15
#trt.int = 1
treat.timing.in <- c(1/366*3, 1/366*6, 1/366*9)
treat.prob.variable.in <- c(0.65, 0.75, 0.8)
#annual biting rate, which determines infection prevalence
ABR.in = 10000
output_MDAvarCov <- ep.equi.sim(time.its = timesteps,
ABR = ABR.in,
N.in = 440,
treat.timing = treat.timing.in,
treat.prob.variable = treat.prob.variable.in,
give.treat = give.treat.in,
treat.start = treat.strt,
treat.stop = treat.stp,
pnc = 0.05,
min.mont.age = 5,
vector.control.strt = NA,
delta.hz.in = 0.186,
delta.hinf.in = 0.003,
c.h.in = 0.005,
gam.dis.in = 0.3,
run_equilibrium = TRUE,
equilibrium = NA,
print_progress = TRUE)
treat.timing
times.of.treat.in
treat.start
i
debugonce(ep.equi.sim)
#annual biting rate, which determines infection prevalence
ABR.in = 10000
output_MDAvarCov <- ep.equi.sim(time.its = timesteps,
ABR = ABR.in,
N.in = 440,
treat.timing = treat.timing.in,
treat.prob.variable = treat.prob.variable.in,
give.treat = give.treat.in,
treat.start = treat.strt,
treat.stop = treat.stp,
pnc = 0.05,
min.mont.age = 5,
vector.control.strt = NA,
delta.hz.in = 0.186,
delta.hinf.in = 0.003,
c.h.in = 0.005,
gam.dis.in = 0.3,
run_equilibrium = TRUE,
equilibrium = NA,
print_progress = TRUE)
treat.timing
debugonce(ep.equi.sim)
devtools::load_all()
timesteps = 45
#should treatment be given, when and how often
give.treat.in = 1
treat.strt = 1 + 1/366*3; treat.stp = 15
#trt.int = 1
treat.timing.in <- c(1+1/366*3, 1+ 1/366*6, 1 + 1/366*9)
treat.prob.variable.in <- c(0.65, 0.75, 0.8)
debugonce(ep.equi.sim)
#annual biting rate, which determines infection prevalence
ABR.in = 10000
output_MDAvarCov <- ep.equi.sim(time.its = timesteps,
ABR = ABR.in,
N.in = 440,
treat.timing = treat.timing.in,
treat.prob.variable = treat.prob.variable.in,
give.treat = give.treat.in,
treat.start = treat.strt,
treat.stop = treat.stp,
pnc = 0.05,
min.mont.age = 5,
vector.control.strt = NA,
delta.hz.in = 0.186,
delta.hinf.in = 0.003,
c.h.in = 0.005,
gam.dis.in = 0.3,
run_equilibrium = TRUE,
equilibrium = NA,
print_progress = TRUE)
treat.timing
times.of.treat.in
i
treat.start
debugonce(ep.equi.sim)
#annual biting rate, which determines infection prevalence
ABR.in = 10000
output_MDAvarCov <- ep.equi.sim(time.its = timesteps,
ABR = ABR.in,
N.in = 440,
treat.timing = treat.timing.in,
treat.prob.variable = treat.prob.variable.in,
give.treat = give.treat.in,
treat.start = treat.strt,
treat.stop = treat.stp,
pnc = 0.05,
min.mont.age = 5,
vector.control.strt = NA,
delta.hz.in = 0.186,
delta.hinf.in = 0.003,
c.h.in = 0.005,
gam.dis.in = 0.3,
run_equilibrium = TRUE,
equilibrium = NA,
print_progress = TRUE)
treat.start
devtools::load_all()
timesteps = 45
#should treatment be given, when and how often
give.treat.in = 1
treat.strt = 1 + 1/366*3; treat.stp = 15
#trt.int = 1
treat.timing.in <- c(1+1/366*3, 1+ 1/366*6, 1 + 1/366*9)
treat.prob.variable.in <- c(0.65, 0.75, 0.8)
#annual biting rate, which determines infection prevalence
ABR.in = 10000
devtools::load_all()
debugonce(ep.equi.sim)
output_MDAvarCov <- ep.equi.sim(time.its = timesteps,
ABR = ABR.in,
N.in = 440,
treat.timing = treat.timing.in,
treat.prob.variable = treat.prob.variable.in,
give.treat = give.treat.in,
treat.start = treat.strt,
treat.stop = treat.stp,
pnc = 0.05,
min.mont.age = 5,
vector.control.strt = NA,
delta.hz.in = 0.186,
delta.hinf.in = 0.003,
c.h.in = 0.005,
gam.dis.in = 0.3,
run_equilibrium = TRUE,
equilibrium = NA,
print_progress = TRUE)
devtools::load_all()
timesteps = 45
#should treatment be given, when and how often
give.treat.in = 1
treat.strt = 3; treat.stp = 15
#trt.int = 1
treat.timing.in <- c(3, 6, 9) # not years, this will instead directly infer the
# (normally this would be years when MDA occur then converetd)
treat.prob.variable.in <- c(0.65, 0.75, 0.8)
timesteps = 45
#should treatment be given, when and how often
give.treat.in = 1
treat.strt = 3; treat.stp = 15
#trt.int = 1
treat.timing.in <- c(3, 6, 9) # not years, this will instead directly infer the
# (normally this would be years when MDA occur then converetd)
# so this is directly the iters rather than the years (ONLY FOR TESTING!)
treat.prob.variable.in <- c(0.65, 0.75, 0.8)
debugonce(ep.equi.sim)
ABR.in = 10000
output_MDAvarCov <- ep.equi.sim(time.its = timesteps,
ABR = ABR.in,
N.in = 440,
treat.timing = treat.timing.in,
treat.prob.variable = treat.prob.variable.in,
give.treat = give.treat.in,
treat.start = treat.strt,
treat.stop = treat.stp,
pnc = 0.05,
min.mont.age = 5,
vector.control.strt = NA,
delta.hz.in = 0.186,
delta.hinf.in = 0.003,
c.h.in = 0.005,
gam.dis.in = 0.3,
run_equilibrium = TRUE,
equilibrium = NA,
print_progress = TRUE)
treat.start
treat.timing
i
times.of.treat.in
treat.start
i
index.iter.treat
times.of.treat.in
treat.prob.variable
treat.prob
treat.prob
treat.prob
Q
debugonce(ep.equi.sim)
ABR.in = 10000
output_MDAvarCov <- ep.equi.sim(time.its = timesteps,
ABR = ABR.in,
N.in = 440,
treat.timing = treat.timing.in,
treat.prob.variable = treat.prob.variable.in,
give.treat = give.treat.in,
treat.start = treat.strt,
treat.stop = treat.stp,
pnc = 0.05,
min.mont.age = 5,
vector.control.strt = NA,
delta.hz.in = 0.186,
delta.hinf.in = 0.003,
c.h.in = 0.005,
gam.dis.in = 0.3,
run_equilibrium = TRUE,
equilibrium = NA,
print_progress = TRUE)
i
treat.prob
treat.prob
i
i
i
i
treat.prob
treat.prob.variable
treat.prob
devtools::load_all()
#should treatment be given, when and how often
give.treat.in = 1
treat.strt = 31; treat.stp = 45
treat.timing.in <- c(1, 2, 3, 4, 10, 11, 11.5, 12, 13, 14, 15)
treat.prob.variable.in <- c(0.65, 0.75, 0.8, 0.85, 0.9, 0.85, 0.5, 0.65, 0.9, 0.8, 0.6)
#annual biting rate, which determines infection prevalence
ABR.in = 10000
output_MDAvarCov <- ep.equi.sim(time.its = timesteps,
ABR = ABR.in,
N.in = 440,
treat.timing = treat.timing.in,
treat.prob.variable = treat.prob.variable.in,
give.treat = give.treat.in,
treat.start = treat.strt,
treat.stop = treat.stp,
pnc = 0.05,
min.mont.age = 5,
vector.control.strt = NA,
delta.hz.in = 0.186,
delta.hinf.in = 0.003,
c.h.in = 0.005,
gam.dis.in = 0.3,
run_equilibrium = TRUE,
equilibrium = NA,
print_progress = TRUE)
devtools::load_all()
timesteps = 45
#should treatment be given, when and how often
# give.treat.in = 1
# treat.strt = 3; treat.stp = 15
# #trt.int = 1
# treat.timing.in <- c(3, 6, 9) # not years, this will instead directly infer the
#                               # (normally this would be years when MDA occur then converetd)
#                               # so this is directly the iters rather than the years (ONLY FOR TESTING!)
#
# treat.prob.variable.in <- c(0.65, 0.75, 0.8)
#should treatment be given, when and how often
give.treat.in = 1
treat.strt = 31; treat.stp = 45
treat.timing.in <- c(1, 2, 3, 4, 10, 11, 11.5, 12, 13, 14, 15)
treat.prob.variable.in <- c(0.65, 0.75, 0.8, 0.85, 0.9, 0.85, 0.5, 0.65, 0.9, 0.8, 0.6)
#annual biting rate, which determines infection prevalence
ABR.in = 10000
output_MDAvarCov <- ep.equi.sim(time.its = timesteps,
ABR = ABR.in,
N.in = 440,
treat.timing = treat.timing.in,
treat.prob.variable = treat.prob.variable.in,
give.treat = give.treat.in,
treat.start = treat.strt,
treat.stop = treat.stp,
pnc = 0.05,
min.mont.age = 5,
vector.control.strt = NA,
delta.hz.in = 0.186,
delta.hinf.in = 0.003,
c.h.in = 0.005,
gam.dis.in = 0.3,
run_equilibrium = TRUE,
equilibrium = NA,
print_progress = TRUE)
names(output_MDAvarCov)
tme <- seq(1, 45*366-1)/366
plot(tme, output_MDAvarCov$coverage.recorded, type = 'l', xlab = 'time (years)', ylab = 'coverage (0-1)', ylim = c(0, 1))
plot(tme, output_MDAvarCov$mf_prev, type = 'l', xlab = 'time (years)', ylab = 'microfilarial prevalence', ylim = c(0, 1))
plot(tme, output_MDAvarCov$mf_prev, type = 'l', xlab = 'time (years)', ylab = 'microfilarial prevalence', ylim = c(0, 1), xlim = c(30,47), xaxt = "n")
axis(1, at = seq(1, 45, by = 1), las=2)
axis(1, at = seq(1, 45, by = 1), las=2)
give.treat.in = 1
treat.strt = 31; treat.stp = 45
#annual biting rate, which determines infection prevalence
ABR.in = 10000
output_MDAvarCov <- ep.equi.sim(time.its = timesteps,
ABR = ABR.in,
N.in = 440,
treat.timing = treat.timing.in,
treat.prob.variable = treat.prob.variable.in,
give.treat = give.treat.in,
treat.start = treat.strt,
treat.stop = treat.stp,
pnc = 0.05,
min.mont.age = 5,
vector.control.strt = NA,
delta.hz.in = 0.186,
delta.hinf.in = 0.003,
c.h.in = 0.005,
gam.dis.in = 0.3,
run_equilibrium = TRUE,
equilibrium = NA,
print_progress = TRUE)
treat.timing.in <- c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 20)
treat.prob.variable.in <- c(0.65, 0.75, 0.8, 0.85, 0.9, 0.85, 0.5, 0.65, 0.9, 0.8, 0.6, 0.95, 0.95, 0.9, 0.8, 0.5, 0.55, 0.85, 0.9)
#annual biting rate, which determines infection prevalence
ABR.in = 10000
output_MDAvarCov <- ep.equi.sim(time.its = timesteps,
ABR = ABR.in,
N.in = 440,
treat.timing = treat.timing.in,
treat.prob.variable = treat.prob.variable.in,
give.treat = give.treat.in,
treat.start = treat.strt,
treat.stop = treat.stp,
pnc = 0.05,
min.mont.age = 5,
vector.control.strt = NA,
delta.hz.in = 0.186,
delta.hinf.in = 0.003,
c.h.in = 0.005,
gam.dis.in = 0.3,
run_equilibrium = TRUE,
equilibrium = NA,
print_progress = TRUE)
names(output_MDAvarCov)
tme <- seq(1, 45*366-1)/366
plot(tme, output_MDAvarCov$coverage.recorded, type = 'l', xlab = 'time (years)', ylab = 'coverage (0-1)', ylim = c(0, 1), xaxt = "n")
axis(1, at = seq(1, 45, by = 1), las=2)
plot(tme, output_MDAvarCov$mf_prev, type = 'l', xlab = 'time (years)', ylab = 'microfilarial prevalence', ylim = c(0, 1))
plot(tme, output_MDAvarCov$mf_prev, type = 'l', xlab = 'time (years)', ylab = 'microfilarial prevalence', ylim = c(0, 1), xlim = c(30,47), xaxt = "n")
axis(1, at = seq(1, 45, by = 1), las=2)
31+19
timesteps = 51
treat.strt = 31; treat.stp = 50
treat.timing.in <- c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 20)
treat.prob.variable.in <- c(0.65, 0.75, 0.8, 0.85, 0.9, 0.85, 0.5, 0.65, 0.9, 0.8, 0.6, 0.95, 0.95, 0.9, 0.8, 0.5, 0.55, 0.85, 0.9)
#annual biting rate, which determines infection prevalence
ABR.in = 10000
output_MDAvarCov <- ep.equi.sim(time.its = timesteps,
ABR = ABR.in,
N.in = 440,
treat.timing = treat.timing.in,
treat.prob.variable = treat.prob.variable.in,
give.treat = give.treat.in,
treat.start = treat.strt,
treat.stop = treat.stp,
pnc = 0.05,
min.mont.age = 5,
vector.control.strt = NA,
delta.hz.in = 0.186,
delta.hinf.in = 0.003,
c.h.in = 0.005,
gam.dis.in = 0.3,
run_equilibrium = TRUE,
equilibrium = NA,
print_progress = TRUE)
names(output_MDAvarCov)
tme <- seq(1, 51*366-1)/366
plot(tme, output_MDAvarCov$coverage.recorded, type = 'l', xlab = 'time (years)', ylab = 'coverage (0-1)', ylim = c(0, 1), xaxt = "n")
axis(1, at = seq(1, 51, by = 1), las=2)
plot(tme, output_MDAvarCov$mf_prev, type = 'l', xlab = 'time (years)', ylab = 'microfilarial prevalence', ylim = c(0, 1))
plot(tme, output_MDAvarCov$mf_prev, type = 'l', xlab = 'time (years)', ylab = 'microfilarial prevalence', ylim = c(0, 1), xlim = c(30,47), xaxt = "n")
axis(1, at = seq(1, 51, by = 1), las=2)
plot(tme, output_MDAvarCov$mf_prev, type = 'l', xlab = 'time (years)', ylab = 'microfilarial prevalence', ylim = c(0, 1), xlim = c(30,51), xaxt = "n")
axis(1, at = seq(1, 51, by = 1), las=2)
debugonce(ep.equi.sim)
output_MDAvarCov <- ep.equi.sim(time.its = timesteps,
ABR = ABR.in,
N.in = 440,
treat.timing = treat.timing.in,
treat.prob.variable = treat.prob.variable.in,
give.treat = give.treat.in,
treat.start = treat.strt,
treat.stop = treat.stp,
pnc = 0.05,
min.mont.age = 5,
vector.control.strt = NA,
delta.hz.in = 0.186,
delta.hinf.in = 0.003,
c.h.in = 0.005,
gam.dis.in = 0.3,
run_equilibrium = TRUE,
equilibrium = NA,
print_progress = TRUE)
treat.timing
length(treat.timing)
times.of.treat.in
length(times.of.treat.in)
times.of.treat.in
18301/366
31 + 20
31 + (20 - 1)
timesteps = 52
treat.strt = 31
treat.stp = 51 # note this must be year after last treatment year in vector of treatment round timings,
# so if last one is at 20 years, last year of treatment is 31 + (20 - 1) = year 50.
# therefore treat.stop needs to be at year 51.
treat.timing.in <- c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 20)
treat.prob.variable.in <- c(0.65, 0.75, 0.8, 0.85, 0.9, 0.85, 0.5, 0.65, 0.9, 0.8, 0.6, 0.95, 0.95, 0.9, 0.8, 0.5, 0.55, 0.85, 0.9)
#annual biting rate, which determines infection prevalence
ABR.in = 10000
output_MDAvarCov <- ep.equi.sim(time.its = timesteps,
ABR = ABR.in,
N.in = 440,
treat.timing = treat.timing.in,
treat.prob.variable = treat.prob.variable.in,
give.treat = give.treat.in,
treat.start = treat.strt,
treat.stop = treat.stp,
pnc = 0.05,
min.mont.age = 5,
vector.control.strt = NA,
delta.hz.in = 0.186,
delta.hinf.in = 0.003,
c.h.in = 0.005,
gam.dis.in = 0.3,
run_equilibrium = TRUE,
equilibrium = NA,
print_progress = TRUE)
names(output_MDAvarCov)
tme <- seq(1, 52*366-1)/366
plot(tme, output_MDAvarCov$coverage.recorded, type = 'l', xlab = 'time (years)', ylab = 'coverage (0-1)', ylim = c(0, 1), xaxt = "n")
axis(1, at = seq(1, 52, by = 1), las=2)
plot(tme, output_MDAvarCov$mf_prev, type = 'l', xlab = 'time (years)', ylab = 'microfilarial prevalence', ylim = c(0, 1))
plot(tme, output_MDAvarCov$mf_prev, type = 'l', xlab = 'time (years)', ylab = 'microfilarial prevalence', ylim = c(0, 1), xlim = c(30,51), xaxt = "n")
axis(1, at = seq(1, 52, by = 1), las=2)
print(paste((1000 - (1000 * 0.7)), 'at', 20, 'yrs', sep = ''))
print(paste((1000 - (1000 * 0.7)), 'at', 20, sep = ''))
print(paste((1000 - (1000 * 0.7)), 'at', 20))
print(paste((1000 - (1000 * 0.7)), 'at', 20, 'yrs'))
devtools::load_all()
output_MDA_freqcovVC <- ep.equi.sim(time.its = timesteps,
ABR = ABR.in,
N.in = 440,
treat.timing = treat.timing.in,
treat.prob.variable = treat.prob.variable.in,
give.treat = give.treat.in,
treat.start = treat.strt,
treat.stop = treat.stp,
pnc = 0.05,
min.mont.age = 5,
#vector.control.strt = NA,
vector.control.strt = 30,
vector.control.duration = 10,
vector.control.efficacy = 0.7,
delta.hz.in = 0.186,
delta.hinf.in = 0.003,
c.h.in = 0.005,
gam.dis.in = 0.3,
run_equilibrium = TRUE,
equilibrium = NA,
print_progress = TRUE)
devtools::load_all()
output_MDA_freqcovVC <- ep.equi.sim(time.its = timesteps,
ABR = ABR.in,
N.in = 440,
treat.timing = treat.timing.in,
treat.prob.variable = treat.prob.variable.in,
give.treat = give.treat.in,
treat.start = treat.strt,
treat.stop = treat.stp,
pnc = 0.05,
min.mont.age = 5,
#vector.control.strt = NA,
vector.control.strt = 30,
vector.control.duration = 10,
vector.control.efficacy = 0.7,
delta.hz.in = 0.186,
delta.hinf.in = 0.003,
c.h.in = 0.005,
gam.dis.in = 0.3,
run_equilibrium = TRUE,
equilibrium = NA,
print_progress = TRUE)
devtools::load_all()
output_MDA_freqcovVC <- ep.equi.sim(time.its = timesteps,
ABR = ABR.in,
N.in = 440,
treat.timing = treat.timing.in,
treat.prob.variable = treat.prob.variable.in,
give.treat = give.treat.in,
treat.start = treat.strt,
treat.stop = treat.stp,
pnc = 0.05,
min.mont.age = 5,
#vector.control.strt = NA,
vector.control.strt = 30,
vector.control.duration = 10,
vector.control.efficacy = 0.7,
delta.hz.in = 0.186,
delta.hinf.in = 0.003,
c.h.in = 0.005,
gam.dis.in = 0.3,
run_equilibrium = TRUE,
equilibrium = NA,
print_progress = TRUE)
