gam.dis.in = 0.1177747,
run_equilibrium = TRUE,
equilibrium = NA,
print_progress = TRUE,
kM.const.toggle = TRUE)
names(output)
tme <- seq(1, 126*366-1)/366
yrs_tme <- seq(2022 - (126-1/366-1/366), 2022, 1/366)
plot(tme, output$mf_prev, type = 'l', xlab = 'time (years)', ylab = 'microfilarial prevalence', ylim = c(0, 1))
plot(yrs_tme, output$mf_prev, type = 'l', xlab = 'time (years)', ylab = 'microfilarial prevalence', ylim = c(0, 1))
plot(yrs_tme, output$mf_prev, type = 'l', xlab = 'time (years)', ylab = 'microfilarial prevalence', ylim = c(0, 0.4), xlim=c(1995,2022))
output1 <- ep.equi.sim(time.its = timesteps,
ABR = ABR.in,
N.in = 440,
treat.timing = NA,
treat.int = trt.int,
treat.prob.variable = treat.prob.variable.in,
give.treat = give.treat.in,
treat.start = treat.strt,
treat.stop = treat.stp,
pnc = 0.05,
min.mont.age = 5,
vector.control.strt = NA, #
delta.hz.in = 0.186,
delta.hinf.in = 0.003,
c.h.in = 0.005,
gam.dis.in = 0.12804371,
run_equilibrium = TRUE,
equilibrium = NA,
print_progress = TRUE)
plot(tme, output$mf_prev, type = 'l', xlab = 'time (years)', ylab = 'microfilarial prevalence', ylim = c(0, 1))
plot(yrs_tme, output$mf_prev, type = 'l', xlab = 'time (years)', ylab = 'microfilarial prevalence', ylim = c(0, 0.4), xlim=c(1995,2022))
plot(yrs_tme, output1$mf_prev, type = 'l', xlab = 'time (years)', ylab = 'microfilarial prevalence', ylim = c(0, 0.4), xlim=c(1995,2022))
output <- ep.equi.sim(time.its = timesteps,
ABR = ABR.in,
N.in = 440,
treat.timing = NA,
treat.int = trt.int,
treat.prob.variable = treat.prob.variable.in,
give.treat = give.treat.in,
treat.start = treat.strt,
treat.stop = treat.stp,
pnc = 0.05,
min.mont.age = 5,
vector.control.strt = NA, #
delta.hz.in = 0.186,
delta.hinf.in = 0.003,
c.h.in = 0.005,
gam.dis.in = 0.1177747,
run_equilibrium = TRUE,
equilibrium = NA,
print_progress = TRUE,
kM.const.toggle = TRUE)
treat.prob.variable.in <- c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0.14, 0.14, 0.14, 0.14, 0.14, 0.23, 0.23, 0.32, 0.32, 0.32, 0.32,
0.42, 0.42, 0.42, 0.51, 0.51, 0.6, 0.69, 0.69, 0.69, 0.69, 0.69, 0.69,
0, 0, 0)
80+48
# IU: CIV15367 (baseline prev: 0.2808506, ABR: 842.5721, kE: 0.1177747, 2022 prev: 0.2082544)
devtools::load_all()
#length of simulation in years
timesteps = 128
#should treatment be given, when and how often
give.treat.in = 1
treat.strt = 81; treat.stp = 128
trt.int = 1
#annual biting rate, which determines infection prevalence (60% microfilarae prevalence)
ABR.in = 843
treat.prob.variable.in <- c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0.14, 0.14, 0.14, 0.14, 0.14, 0.23, 0.23, 0.32, 0.32, 0.32, 0.32,
0.42, 0.42, 0.42, 0.51, 0.51, 0.6, 0.69, 0.69, 0.69, 0.69, 0.69, 0.69,
0, 0, 0)
output <- ep.equi.sim(time.its = timesteps,
ABR = ABR.in,
N.in = 440,
treat.timing = NA,
treat.int = trt.int,
treat.prob.variable = treat.prob.variable.in,
give.treat = give.treat.in,
treat.start = treat.strt,
treat.stop = treat.stp,
pnc = 0.05,
min.mont.age = 5,
vector.control.strt = NA, #
delta.hz.in = 0.186,
delta.hinf.in = 0.003,
c.h.in = 0.005,
gam.dis.in = 0.1177747,
run_equilibrium = TRUE,
equilibrium = NA,
print_progress = TRUE,
kM.const.toggle = TRUE)
names(output)
tme <- seq(1, 128*366-1)/366
yrs_tme <- seq(2022 - (128-1/366-1/366), 2022, 1/366)
plot(tme, output$mf_prev, type = 'l', xlab = 'time (years)', ylab = 'microfilarial prevalence', ylim = c(0, 1))
plot(yrs_tme, output$mf_prev, type = 'l', xlab = 'time (years)', ylab = 'microfilarial prevalence', ylim = c(0, 0.4), xlim=c(1988,2022))
output1 <- ep.equi.sim(time.its = timesteps,
ABR = ABR.in,
N.in = 440,
treat.timing = NA,
treat.int = trt.int,
treat.prob.variable = treat.prob.variable.in,
give.treat = give.treat.in,
treat.start = treat.strt,
treat.stop = treat.stp,
pnc = 0.05,
min.mont.age = 5,
vector.control.strt = NA, #
delta.hz.in = 0.186,
delta.hinf.in = 0.003,
c.h.in = 0.005,
gam.dis.in = 0.12804371,
run_equilibrium = TRUE,
equilibrium = NA,
print_progress = TRUE)
output1 <- ep.equi.sim(time.its = timesteps,
ABR = ABR.in,
N.in = 440,
treat.timing = NA,
treat.int = trt.int,
treat.prob.variable = treat.prob.variable.in,
give.treat = give.treat.in,
treat.start = treat.strt,
treat.stop = treat.stp,
pnc = 0.05,
min.mont.age = 5,
vector.control.strt = NA, #
delta.hz.in = 0.186,
delta.hinf.in = 0.003,
c.h.in = 0.005,
gam.dis.in = 0.1177747,
run_equilibrium = TRUE,
equilibrium = NA,
print_progress = TRUE)
names(output)
tme <- seq(1, 128*366-1)/366
yrs_tme <- seq(2022 - (128-1/366-1/366), 2022, 1/366)
plot(tme, output$mf_prev, type = 'l', xlab = 'time (years)', ylab = 'microfilarial prevalence', ylim = c(0, 1))
plot(yrs_tme, output$mf_prev, type = 'l', xlab = 'time (years)', ylab = 'microfilarial prevalence', ylim = c(0, 0.4), xlim=c(1988,2022))
plot(yrs_tme, output1$mf_prev, type = 'l', xlab = 'time (years)', ylab = 'microfilarial prevalence', ylim = c(0, 0.4), xlim=c(1988,2022))
output <- ep.equi.sim(time.its = timesteps,
ABR = ABR.in,
N.in = 440,
treat.timing = NA,
treat.int = trt.int,
treat.prob.variable = treat.prob.variable.in,
give.treat = give.treat.in,
treat.start = treat.strt,
treat.stop = treat.stp,
pnc = 0.05,
min.mont.age = 5,
vector.control.strt = NA, #
delta.hz.in = 0.186,
delta.hinf.in = 0.003,
c.h.in = 0.005,
gam.dis.in = 0.1177747,
run_equilibrium = TRUE,
equilibrium = NA,
print_progress = TRUE,
kM.const.toggle = TRUE)
output1 <- ep.equi.sim(time.its = timesteps,
ABR = ABR.in,
N.in = 440,
treat.timing = NA,
treat.int = trt.int,
treat.prob.variable = treat.prob.variable.in,
give.treat = give.treat.in,
treat.start = treat.strt,
treat.stop = treat.stp,
pnc = 0.05,
min.mont.age = 5,
vector.control.strt = NA, #
delta.hz.in = 0.186,
delta.hinf.in = 0.003,
c.h.in = 0.005,
gam.dis.in = 0.1177747,
run_equilibrium = TRUE,
equilibrium = NA,
print_progress = TRUE)
plot(yrs_tme, output$mf_prev, type = 'l', xlab = 'time (years)', ylab = 'microfilarial prevalence', ylim = c(0, 0.4), xlim=c(1988,2022))
plot(yrs_tme, output1$mf_prev, type = 'l', xlab = 'time (years)', ylab = 'microfilarial prevalence', ylim = c(0, 0.4), xlim=c(1988,2022))
# ========================================================================================================================== #
#                   TESTING MORBIDITY (SKIN DISEASE) --- Taking EQ inputs -- 30/06/23                                                #
# ========================================================================================================================== #
devtools::load_all()
timesteps = 80
#should treatment be given, when and how often
give.treat.in = 0
treat.strt = 1; treat.stp = 16
trt.int = 1
#annual biting rate, which determines infection prevalence (60% microfilarae prevalence)
ABR.in = 607 # 50% mf prev
output_equilibrium_morbidity <- ep.equi.sim(time.its = timesteps,
ABR = ABR.in,
N.in = 440,
treat.int = trt.int,
treat.prob = 0.65,
give.treat = give.treat.in,
treat.start = treat.strt,
treat.stop = treat.stp,
pnc = 0.05,
min.mont.age = 5,
vector.control.strt = NA, #
delta.hz.in = 0.186,
delta.hinf.in = 0.003,
c.h.in = 0.005,
gam.dis.in = 0.3,
run_equilibrium = TRUE,
equilibrium,
print_progress = TRUE,
morbidity_module2 = "YES")
names(output_equilibrium_morbidity)
output_equilibrium <- output_equilibrium_morbidity
output_equilibrium[[13]]
devtools::load_all()
timesteps = 30
treat.strt = 1; treat.stp = 26 #if model run stops in year 30, the last round is at the beginning of year 25
gv.trt = 1
trt.int = 1
output_equilibrium <- output_equilibrium_morbidity
output_equilibrium_morbidity2 <- ep.equi.sim(time.its = timesteps,
ABR = ABR.in,
N.in = 440,
treat.int = trt.int,
treat.prob = 0.65,
give.treat = give.treat.in,
treat.start = treat.strt,
treat.stop = treat.stp,
pnc = 0.05,
min.mont.age = 5,
vector.control.strt = NA, #
delta.hz.in = 0.186,
delta.hinf.in = 0.003,
c.h.in = 0.005,
gam.dis.in = 0.3,
run_equilibrium = FALSE,
equilibrium = output_equilibrium[[4]],
morbidity_eq = output_equilibrium[[13]],
morbidity_ageprev_eq = output_equilibrium[[14]],
print_progress = TRUE,
morbidity_module2 = "YES")
output_equilibrium$morbidity_ageprev_out[[8]]
timesteps = 30
treat.strt = 1; treat.stp = 26 #if model run stops in year 30, the last round is at the beginning of year 25
gv.trt = 1
trt.int = 1
output_equilibrium <- output_equilibrium_morbidity
output_equilibrium_morbidity2 <- ep.equi.sim(time.its = timesteps,
ABR = ABR.in,
N.in = 440,
treat.int = trt.int,
treat.prob = 0.65,
give.treat = give.treat.in,
treat.start = treat.strt,
treat.stop = treat.stp,
pnc = 0.05,
min.mont.age = 5,
vector.control.strt = NA, #
delta.hz.in = 0.186,
delta.hinf.in = 0.003,
c.h.in = 0.005,
gam.dis.in = 0.3,
run_equilibrium = FALSE,
equilibrium = output_equilibrium[[4]],
morbidity_eq = output_equilibrium[[13]],
morbidity_ageprev_eq = output_equilibrium[[10]],
print_progress = TRUE,
morbidity_module2 = "YES")
output_equilibrium$morbidity_ageprev_out[[36]]
output_equilibrium$morbidity_ageprev_out
morbidity_ageprev_eq_test <- output_equilibrium[[10]]
View(morbidity_ageprev_eq_test)
morbidity_prev_eq <- c(output_equilibrium$severe_itch_prev, output_equilibrium$RSD_prev,
output_equilibrium$atrophy_prev, output_equilibrium$hanging_groin_prev,
output_equilibrium$hanging_groin_prev)
morbidity_ageprev_eq
morbidity_prev_eq
morbidity_prev_eq <- list(c(output_equilibrium$severe_itch_prev, output_equilibrium$RSD_prev,
output_equilibrium$atrophy_prev, output_equilibrium$hanging_groin_prev,
output_equilibrium$hanging_groin_prev))
morbidity_prev_eq
View(morbidity_prev_eq)
morbidity_prev_eq <- list(output_equilibrium$severe_itch_prev, output_equilibrium$RSD_prev,
output_equilibrium$atrophy_prev, output_equilibrium$hanging_groin_prev,
output_equilibrium$hanging_groin_prev)
View(morbidity_prev_eq)
View(morbidity_prev_eq)
View(morbidity_ageprev_eq_test)
morbidity_ageprev_eq_test[[35]]
morbidity_ageprev_eq_test[[36]]
output_equilibrium_morbidity2 <- ep.equi.sim(time.its = timesteps,
ABR = ABR.in,
N.in = 440,
treat.int = trt.int,
treat.prob = 0.65,
give.treat = give.treat.in,
treat.start = treat.strt,
treat.stop = treat.stp,
pnc = 0.05,
min.mont.age = 5,
vector.control.strt = NA, #
delta.hz.in = 0.186,
delta.hinf.in = 0.003,
c.h.in = 0.005,
gam.dis.in = 0.3,
run_equilibrium = FALSE,
equilibrium = output_equilibrium[[4]],
morbidity_eq = output_equilibrium[[13]],
morbidity_ageprev_eq = output_equilibrium[[10]],
morbidity_ageprev_eq = morbidity_ageprev_eq,
print_progress = TRUE,
morbidity_module2 = "YES")
output_equilibrium_morbidity2 <- ep.equi.sim(time.its = timesteps,
ABR = ABR.in,
N.in = 440,
treat.int = trt.int,
treat.prob = 0.65,
give.treat = give.treat.in,
treat.start = treat.strt,
treat.stop = treat.stp,
pnc = 0.05,
min.mont.age = 5,
vector.control.strt = NA, #
delta.hz.in = 0.186,
delta.hinf.in = 0.003,
c.h.in = 0.005,
gam.dis.in = 0.3,
run_equilibrium = FALSE,
equilibrium = output_equilibrium[[4]],
morbidity_eq = output_equilibrium[[13]],
morbidity_ageprev_eq = output_equilibrium[[10]],
morbidity_prev_eq = morbidity_prev_eq,
print_progress = TRUE,
morbidity_module2 = "YES")
View(morbidity_prev_eq)
debugonce(ep.equi.sim)
output_equilibrium_morbidity2 <- ep.equi.sim(time.its = timesteps,
ABR = ABR.in,
N.in = 440,
treat.int = trt.int,
treat.prob = 0.65,
give.treat = give.treat.in,
treat.start = treat.strt,
treat.stop = treat.stp,
pnc = 0.05,
min.mont.age = 5,
vector.control.strt = NA, #
delta.hz.in = 0.186,
delta.hinf.in = 0.003,
c.h.in = 0.005,
gam.dis.in = 0.3,
run_equilibrium = FALSE,
equilibrium = output_equilibrium[[4]],
morbidity_eq = output_equilibrium[[13]],
morbidity_ageprev_eq = output_equilibrium[[10]],
morbidity_prev_eq = morbidity_prev_eq,
print_progress = TRUE,
morbidity_module2 = "YES")
debugonce(ep.equi.sim)
output_equilibrium_morbidity2 <- ep.equi.sim(time.its = timesteps,
ABR = ABR.in,
N.in = 440,
treat.int = trt.int,
treat.prob = 0.65,
give.treat = give.treat.in,
treat.start = treat.strt,
treat.stop = treat.stp,
pnc = 0.05,
min.mont.age = 5,
vector.control.strt = NA, #
delta.hz.in = 0.186,
delta.hinf.in = 0.003,
c.h.in = 0.005,
gam.dis.in = 0.3,
run_equilibrium = FALSE,
equilibrium = output_equilibrium[[4]],
morbidity_eq = output_equilibrium[[13]],
morbidity_ageprev_eq = output_equilibrium[[10]],
morbidity_prev_eq = morbidity_prev_eq,
print_progress = TRUE,
morbidity_module2 = "YES")
devtools::load_all()
output_equilibrium_morbidity2 <- ep.equi.sim(time.its = timesteps,
ABR = ABR.in,
N.in = 440,
treat.int = trt.int,
treat.prob = 0.65,
give.treat = give.treat.in,
treat.start = treat.strt,
treat.stop = treat.stp,
pnc = 0.05,
min.mont.age = 5,
vector.control.strt = NA, #
delta.hz.in = 0.186,
delta.hinf.in = 0.003,
c.h.in = 0.005,
gam.dis.in = 0.3,
run_equilibrium = FALSE,
equilibrium = output_equilibrium[[4]],
morbidity_eq = output_equilibrium[[13]],
morbidity_ageprev_eq = output_equilibrium[[10]],
morbidity_prev_eq = morbidity_prev_eq,
print_progress = TRUE,
morbidity_module2 = "YES")
names(output_equilibrium_morbidity)
morb.test <- output_equilibrium$morbidity.outputs
View(morb.test)
morb.test <- output_equilibrium$morbidity.outputs[[1]]
View(morb.test)
output_equilibrium[[4]]
morb.test2 <- output_equilibrium[[13]]
View(morb.test2)
output_equilibrium_morbidity2 <- ep.equi.sim(time.its = timesteps,
ABR = ABR.in,
N.in = 440,
treat.int = trt.int,
treat.prob = 0.65,
give.treat = give.treat.in,
treat.start = treat.strt,
treat.stop = treat.stp,
pnc = 0.05,
min.mont.age = 5,
vector.control.strt = NA, #
delta.hz.in = 0.186,
delta.hinf.in = 0.003,
c.h.in = 0.005,
gam.dis.in = 0.3,
run_equilibrium = FALSE,
equilibrium = output_equilibrium[[4]],
morbidity_eq = output_equilibrium[[13]],
morbidity_ageprev_eq = output_equilibrium[[10]],
morbidity_prev_eq = morbidity_prev_eq,
print_progress = TRUE,
morbidity_module2 = "YES")
devtools::load_all()
output_equilibrium_morbidity2 <- ep.equi.sim(time.its = timesteps,
ABR = ABR.in,
N.in = 440,
treat.int = trt.int,
treat.prob = 0.65,
give.treat = give.treat.in,
treat.start = treat.strt,
treat.stop = treat.stp,
pnc = 0.05,
min.mont.age = 5,
vector.control.strt = NA, #
delta.hz.in = 0.186,
delta.hinf.in = 0.003,
c.h.in = 0.005,
gam.dis.in = 0.3,
run_equilibrium = FALSE,
equilibrium = output_equilibrium[[4]],
morbidity_eq = output_equilibrium[[13]],
morbidity_ageprev_eq = output_equilibrium[[10]],
morbidity_prev_eq = morbidity_prev_eq,
print_progress = TRUE,
morbidity_module2 = "YES")
morbidity_ageprev_eq_test <- output_equilibrium[[10]]
View(morbidity_ageprev_eq_test)
morbidity_ageprev_eq_test[[1]]
morbidity_ageprev_eq_test$SI_prev0_1
devtools::load_all()
output_equilibrium_morbidity2 <- ep.equi.sim(time.its = timesteps,
ABR = ABR.in,
N.in = 440,
treat.int = trt.int,
treat.prob = 0.65,
give.treat = give.treat.in,
treat.start = treat.strt,
treat.stop = treat.stp,
pnc = 0.05,
min.mont.age = 5,
vector.control.strt = NA, #
delta.hz.in = 0.186,
delta.hinf.in = 0.003,
c.h.in = 0.005,
gam.dis.in = 0.3,
run_equilibrium = FALSE,
equilibrium = output_equilibrium[[4]],
morbidity_eq = output_equilibrium[[13]],
morbidity_ageprev_eq = output_equilibrium[[10]],
morbidity_prev_eq = morbidity_prev_eq,
print_progress = TRUE,
morbidity_module2 = "YES",
mf_ageprev_eq = output_equilibrium[[14]],
mf_agintens_eq = output_equilibrium[[15]])
devtools::load_all()
output_equilibrium_morbidity2 <- ep.equi.sim(time.its = timesteps,
ABR = ABR.in,
N.in = 440,
treat.int = trt.int,
treat.prob = 0.65,
give.treat = give.treat.in,
treat.start = treat.strt,
treat.stop = treat.stp,
pnc = 0.05,
min.mont.age = 5,
vector.control.strt = NA, #
delta.hz.in = 0.186,
delta.hinf.in = 0.003,
c.h.in = 0.005,
gam.dis.in = 0.3,
run_equilibrium = FALSE,
equilibrium = output_equilibrium[[4]],
morbidity_eq = output_equilibrium[[13]],
morbidity_ageprev_eq = output_equilibrium[[10]],
morbidity_prev_eq = morbidity_prev_eq,
print_progress = TRUE,
morbidity_module2 = "YES",
mf_ageprev_eq = output_equilibrium[[14]],
mf_agintens_eq = output_equilibrium[[15]])
